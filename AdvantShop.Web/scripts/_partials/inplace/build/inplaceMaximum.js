!function(e){"use strict";window.angular.module("inplace",[]).constant("inplaceRichConfig",{title:!1,allowedContent:!0,autoParagraph:!1,removePlugins:"dragdrop, basket",floatSpaceDockedOffsetY:5,toolbar:[{name:"source",items:["Sourcedialog","Templates"]},{name:"elements",items:["NumberedList","BulletedList","Link","Unlink","-","Image","Flash","Table","HorizontalRule"]},{name:"styles",items:["Format","Font","FontSize","lineheight"]},"/",{name:"text",items:["Bold","Italic","Underline","Strike","Subscript","RemoveFormat"]},{name:"text",items:["TextColor","BGColor"]},{name:"align",items:["Outdent","Indent","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"document",items:["PasteFromWord","Undo","Redo","Scayt"]}],extraPlugins:"scriptencode,sourcedialog,codemirror,lineheight",codemirror:{}})}(),function(e){"use strict";e.module("inplace").directive("inplaceStart",["$compile","$rootScope",function(e,t){return{restrict:"A",scope:{},link:function(n,a,i,l){var c=document.querySelectorAll("[data-inplace-rich], [data-inplace-modal], [data-inplace-image], [data-inplace-autocomplete], [data-inplace-properties-new], [data-inplace-image], [data-inplace-price], [data-inplace-price-panel], [data-inplace-switch]");null!=c&&c.length>0&&e(c)(t)}}}]),e.module("inplace").directive("inplaceSwitch",[function(e){return{restrict:"A",scope:!0,controller:"InplaceSwitchCtrl",controllerAs:"inplaceSwitch",bindToController:!0}}]),e.module("inplace").directive("inplaceProgress",function(){return{restrict:"A",scope:{},controller:"InplaceProgressCtrl",controllerAs:"inplaceProgress",bindToController:!0,replace:!0,template:'<div class="inplace-progress icon-spinner-before icon-animate-spin-before" data-ng-if="inplaceProgress.state.show === true"></div>'}})}(window.angular),function(e){"use strict";var t=0,n=0,a=0,i=0;"undefined"!=typeof CKEDITOR&&null!=CKEDITOR&&!0===CKEDITOR.env.isCompatible&&(e.module("inplace").directive("inplaceRich",["$compile","$document","$locale","$timeout","$window","inplaceService","inplaceRichConfig",function(n,a,i,l,c,o,r){return{restrict:"A",scope:{inplaceRich:"&",inplaceUrl:"@"},controller:"InplaceRichCtrl",controllerAs:"inplaceRich",bindToController:!0,link:function(u,p,s,d){d.getParams=function(){return new Function("return "+p.attr("data-inplace-params"))()||{}},l(function(){var l,m,f,g=e.extend(e.copy(r),d.inplaceRich()||{},{language:"ru-ru"===i.id?"ru":"uk-ua"===i.id?"ua":"en"});null==s.id&&(s.$set("id","inplaceRich_"+t),t+=1),!0===g.editorSimple&&(g.removePlugins="toolbar, showborders, magicline",g.enterMode=CKEDITOR.ENTER_BR,g.forcePasteAsPlainText=!0,p.addClass("inplace-rich-simple")),f=function(e,t){e.css({top:c.pageYOffset+t.bottom+"px",right:a[0].body.clientWidth-t.right+"px"})},m=function(e,t){null!=l&&clearTimeout(l),l=setTimeout(function(){f(e,t[0].getBoundingClientRect()),m(e,t)},100)},p.find("script").removeAttr("type"),null!=document.getElementById(s.id)&&(d.editor=CKEDITOR.inline(s.id,g),null!=d.editor&&(d.editor.on("instanceReady",function(e){0===d.editor.getData().trim().length&&null!=s.placeholder&&(p.addClass("inplace-rich-empty"),d.editor.setData(s.placeholder))}),d.editor.on("focus",function(t){d.editor.getData().trim()===s.placeholder&&(p.removeClass("inplace-rich-empty"),d.editor.setData("")),u.$apply(function(){var t;d.active(),null==d.buttonsRendered||!1===d.buttonsRendered?(t=e.element('<div inplace-rich-buttons="'+s.id+'"></div>'),document.body.appendChild(t[0]),n(t)(u),d.buttonsRendered=!0):t=d.buttons.element,m(t,p)})}),d.editor.on("blur",function(e){clearTimeout(l),setTimeout(function(){u.$apply(function(){d.isShow=!1,!1!==d.clickedButtons&&null!=d.clickedButtons||d.save(),d.clickedButtons=!1,0===d.editor.getData().trim().length&&null!=s.placeholder&&(p.addClass("inplace-rich-empty"),d.editor.setData(s.placeholder))})},100)}),d.editor.on("key",function(e){switch(e.data.keyCode){case 13:if(!0===g.editorSimple){var t=document.createElement("input"),n=p[0].getBoundingClientRect();t.className="inplace-input-fake",t.style.top=n.top+"px",t.style.left=n.left+"px",document.body.appendChild(t),t.focus(),setTimeout(function(){t.parentNode.removeChild(t)},100),e.stop(),e.cancel()}}}),CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name,n=e.data.definition;if("table"==t){var a=n.getContents("info");a.get("txtWidth").default=null,a.get("txtBorder").default=null,a.get("txtCellPad").default=null,a.get("txtCellSpace").default=null}}),o.addRich(s.id,d)))})}}}]),e.module("inplace").directive("inplaceRichButtons",function(){return{restrict:"A",scope:{inplaceRichButtons:"@"},controller:"InplaceRichButtonsCtrl",controllerAs:"inplaceRichButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/richButtons.html"}}),e.module("inplace").directive("inplacePrice",["$compile","$document","$locale","$window","inplaceService","productService","domService",function(t,n,a,l,c,o,r){return{restrict:"A",scope:{inplaceParams:"&",inplaceUrl:"@"},controller:"InplacePriceCtrl",controllerAs:"inplacePrice",bindToController:!0,link:function(u,p,s,d){var m,f;d.product=o.getProduct(),p[0].classList.add("inplace-price-container"),p[0].classList.add("inplace-offset"),f=function(o){var s,f,g,v,h=r.closest(o.target,".price-current"),I=r.closest(o.target,".price-unknow"),P=r.closest(o.target,".price-old"),b=r.closest(o.target,".price-discount-percent"),w={language:"ru-ru"===a.id?"ru":"uk-ua"===a.id?"ua":"en"};null!=h?(s=h,d.type="price"):null!=I?(s=I,d.type="price"):null!=P?(s=P,d.type="price"):null!=b&&(s=b,d.type="discountPercent"),null==s||!1===d.needReinit[d.type]&&null!=m||(d.needReinit[d.type]=!0,null!=(m=s.querySelector(".price-number")||I||b)&&(null!=m.id&&0!==m.id.length||(m.id="inplacePrice_"+i,i+=1),null==CKEDITOR.instances[m.id]&&(w.removePlugins="toolbar, showborders, magicline",w.enterMode=CKEDITOR.ENTER_BR,w.forcePasteAsPlainText=!0,m.classList.add("inplace-rich-simple"),v=function(e,t,a){e.css({top:l.pageYOffset+a.bottom,right:n[0].body.clientWidth-a.right}),t.css({top:l.pageYOffset+a.top-40,left:a.left})},g=function(e,t,n){null!=f&&clearTimeout(f),f=setTimeout(function(){null!=m&&(v(e,t,m.getBoundingClientRect()),g(e,t,n))},100)},m.setAttribute("contenteditable","true"),d.editor=CKEDITOR.inline(m.id,w),d.editor.on("focus",function(n){!0===m.classList.contains("price-unknown")&&null==d.convertToFloat(d.editor.getData({format:"text"}))&&d.editor.setData("0"),u.$apply(function(){var n,a;d.active(),null==d.buttonsRendered||!1===d.buttonsRendered?(n=e.element('<div data-inplace-price-buttons="'+m.id+'"></div>'),document.body.appendChild(n[0]),t(n)(u),a=e.element('<div data-inplace-price-panel="'+m.id+'"></div>'),document.body.appendChild(a[0]),t(a)(u),d.buttonsRendered=!0):(n=d.buttons.element,a=d.panel.element),g(n,a,m)})}),d.editor.on("blur",function(e){clearTimeout(f),setTimeout(function(){u.$apply(function(){d.isShow=!1,!1!==d.clickedButtons&&null!=d.clickedButtons||d.save(),d.clickedButtons=!1})},100)}),d.editor.on("key",function(e){if(13===e.data.keyCode){var t=document.createElement("input"),n=p[0].getBoundingClientRect();t.className="inplace-input-fake",t.style.top=n.top+"px",t.style.left=n.left+"px",document.body.appendChild(t),t.focus(),setTimeout(function(){t.parentNode.removeChild(t)},100),e.stop(),e.cancel()}else null===d.convertToFloat(d.editor.getData())?m.classList.add("inplace-price-error"):m.classList.remove("inplace-price-error")}),c.addInplacePrice(m.id,d))))},p[0].addEventListener("mouseover",function(e){u.$apply(function(){f(e)})})}}}]),e.module("inplace").directive("inplacePriceButtons",function(){return{restrict:"A",scope:{inplacePriceButtons:"@"},controller:"InplacePriceButtonsCtrl",controllerAs:"inplacePriceButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/priceButtons.html"}}),e.module("inplace").directive("inplacePricePanel",["$compile","$document","$window","inplaceService",function(e,t,n,a){return{restrict:"A",scope:{inplacePricePanel:"@"},controller:"InplacePricePanelCtrl",controllerAs:"inplacePricePanel",templateUrl:"/scripts/_partials/inplace/templates/pricePanel.html",replace:!0,bindToController:!0}}])),e.module("inplace").directive("inplaceModal",[function(){return{restrict:"A",scope:{inplaceParams:"&",inplaceUrl:"@"},controller:"InplaceModalCtrl",controllerAs:"inplaceModal",bindToController:!0,link:function(e,t,n,a){t[0].addEventListener("click",function(t){t.preventDefault(),e.$apply(a.modalOpen)})}}}]),e.module("inplace").directive("inplaceAutocomplete",["$compile","$document","$window","inplaceService",function(t,a,i,l){return{restrict:"A",scope:{inplaceParams:"&",autocompleteParams:"&inplaceAutocomplete",inplaceAutocompleteSelectorBlock:"@"},controller:"InplaceAutocompleteCtrl",controllerAs:"inplaceAutocomplete",bindToController:!0,templateUrl:"/scripts/_partials/inplace/templates/inplaceAutocomplete.html",replace:!0,transclude:!0,link:function(c,o,r,u,p){var s,d=o[0].querySelector("input"),m=p()[0];m&&(u.value=m.textContent),s=function(e,t){e.css({top:i.pageYOffset+t.bottom,right:a[0].body.clientWidth-t.right})},d.addEventListener("focus",function(){var n;o[0].classList.add("inplace-autocomplete-focus"),c.$apply(function(){u.startContent=u.value,u.active(),null==u.buttonsRendered&&(n=e.element('<div inplace-autocomplete-buttons="'+r.id+'"></div>'),s(n,o[0].getBoundingClientRect()),document.body.appendChild(n[0]),t(n)(c),u.buttonsRendered=!0)})}),d.addEventListener("blur",function(){o[0].classList.remove("inplace-autocomplete-focus"),setTimeout(function(){c.$apply(function(){u.isShow=!1,!1!==u.clickedButtons&&null!=u.clickedButtons||u.save(),u.clickedButtons=!1})},100)}),d.addEventListener("keyup",function(e){var t,n;13===e.keyCode&&(o[0].classList.remove("inplace-autocomplete-focus"),t=document.createElement("input"),n=o[0].getBoundingClientRect(),t.className="inplace-input-fake",t.style.top=n.top+"px",t.style.left=n.left+"px",document.body.appendChild(t),t.focus(),setTimeout(function(){t.parentNode.removeChild(t)},100))}),null==r.id&&(r.$set("id","inplaceAutocomplete_"+n),n+=1),l.addInplaceAutocomplete(r.id,u)}}}]),e.module("inplace").directive("inplaceAutocompleteButtons",function(){return{restrict:"A",scope:{inplaceAutocompleteButtons:"@"},controller:"InplaceAutocompleteButtonsCtrl",controllerAs:"inplaceAutocompleteButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/inplaceAutocompleteButtons.html"}}),e.module("inplace").directive("inplacePropertiesNew",function(){return{restrict:"A",scope:{productId:"@"},controller:"InplacePropertiesNewCtrl",controllerAs:"inplacePropertiesNew",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/propertiesNew.html"}}),e.module("inplace").directive("inplaceImage",["$compile","$document","$parse","$timeout","$window","inplaceService",function(t,n,i,l,c,o){return{restrict:"A",require:["inplaceImage","^?carousel","?^productViewItem","?^^","?^zoomer"],scope:!0,controller:"InplaceImageCtrl",controllerAs:"inplaceImage",bindToController:!0,replace:!0,link:function(n,c,r,u){var p,s,d,m,f,g=u[0],v=u[1],h=u[2],I=u[4],P=document.querySelector('[data-ng-controller="ProductCtrl as product"]');null==r.id&&(r.$set("id","inplaceImage_"+a),a+=1),g.carousel=v,g.productViewItem=h,g.product=null!=P?e.element(P).controller():null,g.inplaceParams=i(r.inplaceParams)(n),g.inplaceUrl=r.inplaceUrl,g.inplaceImageButtonsVisible=e.extend({add:!0,update:!0,delete:!0,permanentVisible:!1},new Function("return "+r.inplaceImageButtonsVisible)()||{}),p=function(e,t){return null!=f&&l.cancel(f),f=l(function(){return t.css({top:e[0].offsetTop+e[0].height,left:e[0].offsetLeft+e[0].width-t[0].offsetWidth}),!0},100)},s=function(a){var i=e.element('<div inplace-image-buttons="'+r.id+'"></div>');a[0].parentNode.appendChild(i[0]),t(i)(n),g.buttonsRendered=!0,p(a,i).finally(function(){g.buttons.rendered=!0})},d=function(){c[0].classList.add("inplace-image-focus"),n.$apply(function(){g.active(),null==g.buttonsRendered?s(c):null!=g.buttons&&null!=g.buttons.element&&p(c,g.buttons.element)})},m=function(){c[0].classList.remove("inplace-image-focus"),g.isActive=!1,setTimeout(function(){n.$apply(function(){null==g.buttons||0!=g.buttons.isHoverButtons&&null!=g.buttons.isHoverButtons||!0===g.inplaceImageButtonsVisible.permanentVisible||(g.showButtons=!1)})},100),null!=f&&l.cancel(f)},!0===g.inplaceImageButtonsVisible.permanentVisible&&s(c),null!=I?(c[0].parentNode.addEventListener("mouseenter",d),c[0].parentNode.addEventListener("mouseleave",m)):(c[0].addEventListener("mouseenter",d),c[0].addEventListener("mouseleave",m)),o.addInplaceImage(r.id,g)}}}]),e.module("inplace").directive("inplaceImageButtons",function(){return{restrict:"A",scope:{inplaceImageButtons:"@"},controller:"InplaceImageButtonsCtrl",controllerAs:"inplaceImageButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/inplaceImageButtons.html",link:function(e,t,n,a){a.element=t,!0!==a.buttonsVisible.permanentVisible?(t[0].addEventListener("mouseenter",function(){e.$apply(function(){a.isHoverButtons=!0})}),t[0].addEventListener("mouseleave",function(){e.$apply(function(){a.isHoverButtons=!1}),setTimeout(function(){e.$apply(function(){0!=a.inplaceImage.isActive&&null!=a.inplaceImage.isActive||(a.inplaceImage.showButtons=!1)})},100)})):a.inplaceImage.showButtons=!0}}})}(window.angular),function(e){"use strict";var t=function(e,t){this.change=function(n){t.setEnable(n).then(function(t){!0===t&&e.location.reload()})}};window.angular.module("inplace").controller("InplaceSwitchCtrl",t),t.$inject=["$window","inplaceService"]}(),function(e){"use strict";var t=function(t){var n=this;n.active=function(){n.isShow=!0,n.startContent=n.editor.getData()},n.save=function(){var a,i=n.editor.getData();n.startContent!==i&&(a=e.extend(n.getParams(),{content:i}),t.save(n.inplaceUrl,a).finally(function(){n.isShow=!1}))},n.cancel=function(){n.isShow=!1,n.editor.setData(n.startContent)}};e.module("inplace").controller("InplaceRichCtrl",t),t.$inject=["inplaceService"]}(window.angular),function(e){"use strict";var t=function(e,t){var n=this;n.$onInit=function(){n.richCtrl=t.getRich(n.inplaceRichButtons),n.richCtrl.buttons={element:e,ctrl:n}},n.btnSave=function(){n.richCtrl.clickedButtons=!0,n.richCtrl.save()},n.btnCancel=function(){n.richCtrl.clickedButtons=!0,n.richCtrl.cancel()}};window.angular.module("inplace").controller("InplaceRichButtonsCtrl",t),t.$inject=["$element","inplaceService"]}(),function(e){"use strict";var t=function(t,n,a,i,l,c){var o=this;o.$onInit=function(){o.inplaceParams=o.inplaceParams()},o.modalOpen=function(){var r,u;!1===l.hasModal("inplaceModal")&&l.renderModal("inplaceModal",c.instant("Js.Inplace.SeoSettings"),"<div data-ng-include=\"'/scripts/_partials/inplace/templates/modal.html'\"></div>","<div data-ng-include=\"'/scripts/_partials/inplace/templates/modalButtons.html'\"></div>",null,{inplace:o}),r=l.getModal("inplaceModal"),u=t.get("inplaceeditor/getmeta",{params:e.extend(o.inplaceParams,{rnd:Math.random()})}),n.all([r,u]).then(function(e){l.open("inplaceModal"),o.startData=e[1].data,o.current=e[1].data,e[0].modalScope.formData=o.current}),o.apply=function(){i.save(o.inplaceUrl,e.extend(o.inplaceParams,o.current)).then(function(){a.location.reload()})}},o.reset=function(){l.close("inplaceModal"),o.current=o.startData}};e.module("inplace").controller("InplaceModalCtrl",t),t.$inject=["$http","$q","$window","inplaceService","modalService","$translate"]}(window.angular),function(e){"use strict";var t=function(t,n,a,i,l,c,o){var r,u=this,p=!1;u.$onInit=function(){u.autocompleteParams=u.autocompleteParams(),u.inplaceParams=u.inplaceParams()},u.active=function(){u.isShow=!0},u.save=function(){u.startContent!==u.value&&l.save("inplaceeditor/propertyupdate",e.extend(u.inplaceParams,{content:u.value})).then(function(t){var n=t.data;!0===n.result?(c.pop("success",o.instant("Js.Inplace.PropertyHasBeenUpdate")),null!=n.obj&&e.extend(u.inplaceParams,n.obj),u.startContent=u.value):c.pop("error",o.instant("Js.Inplace.ErrorPropertyUpdate"))}).catch(function(){c.pop("error",o.instant("Js.Inplace.ErrorPropertyUpdate"))}).finally(function(){u.isShow=!1})},u.cancel=function(){u.isShow=!1,u.value=u.startContent},u.autocompleteApply=function(e,t){u.inplaceParams.propertyValueId=null!=t?t.Key:null},u.delete=function(t){var n;null!=u.inplaceAutocompleteSelectorBlock&&(n=i.closest(t.target,u.inplaceAutocompleteSelectorBlock)),null!=n&&n.parentNode.removeChild(n),u.value=null,l.save("inplaceeditor/propertydelete",e.extend(u.inplaceParams,{content:u.value})).finally(function(){u.isShow=!1,c.pop("success",o.instant("Js.Inplace.PropertyHasBeenDelete")),u.getPropertiesHtml(u.inplaceParams.productId).then(function(e){u.generate(e)})})},u.getPropertiesHtml=function(e){return n.get("/product/productproperties",{params:{productId:e,renderInplaceBlock:!1,rnd:Math.random()}}).then(function(e){return e.data})},u.generate=function(e){var n;!1===p&&((n=document.getElementById("properties")).parentNode.removeChild(n),p=!0),(r=r||document.getElementById("inplacePropertiesNewContainer")).innerHTML=e,t(r)(a)}};e.module("inplace").controller("InplaceAutocompleteCtrl",t),t.$inject=["$compile","$http","$scope","domService","inplaceService","toaster","$translate"]}(window.angular),function(e){"use strict";var t=function(e){var t=this;t.$onInit=function(){t.inplaceAutocomplete=e.getInplaceAutocomplete(t.inplaceAutocompleteButtons)},t.btnSave=function(){t.inplaceAutocomplete.clickedButtons=!0,t.inplaceAutocomplete.save()},t.btnCancel=function(){t.inplaceAutocomplete.clickedButtons=!0,t.inplaceAutocomplete.cancel()}};window.angular.module("inplace").controller("InplaceAutocompleteButtonsCtrl",t),t.$inject=["inplaceService"]}(),function(e){"use strict";var t=function(t,n,a,i,l,c,o){var r,u=!1,p=this;p.$onInit=function(){p.autocompleteValueParams={productId:p.productId},p.inplaceParams={productId:p.productId}},p.save=function(){i(function(){return c.save("inplaceeditor/propertyadd",e.extend(p.inplaceParams,{name:p.name,value:p.value})).then(function(e){null!=e.data?(p.name="",p.value="",p.form.$setPristine(),p.inplaceParams.propertyId=null,p.inplaceParams.propertyValueId=null,l.pop("success",o.instant("Js.Inplace.PropertyHasBeenAdded")),p.htmlUpdate=!0,p.getPropertiesHtml(p.productId).then(function(e){p.generate(e)})):l.pop("error",o.instant("Js.Inplace.ErrorPropertyAdding"))})},100)},p.autocompleteNameApply=function(e,t){null!=t?(p.autocompleteValueParams.propertyId=t.Key,p.inplaceParams.propertyId=t.Key):(p.autocompleteValueParams.propertyId=null,p.inplaceParams.propertyId=null),p.inplaceParams.name=e},p.autocompleteValueApply=function(e,t){p.inplaceParams.propertyValueId=null!=t?t.Key:null,p.inplaceParams.value=e},p.getPropertiesHtml=function(e){return n.get("/product/productproperties",{params:{productId:e,renderInplaceBlock:!1,rnd:Math.random()}}).then(function(e){return e.data})},p.generate=function(e){var n;!1===u&&(null!=(n=document.getElementById("properties"))&&n.parentNode.removeChild(n),u=!0),(r=r||document.getElementById("inplacePropertiesNewContainer")).innerHTML=e,t(r)(a)}};e.module("inplace").controller("InplacePropertiesNewCtrl",t),t.$inject=["$compile","$http","$scope","$timeout","toaster","inplaceService","$translate"]}(window.angular),function(e){"use strict";var t=function(t,n,a,i,l,c,o){var r=this;r.$onInit=function(){r.tagImage=n[0],r.isActive=!1,r.isHoverButtons=!1},r.active=function(){r.isActive=!0,r.showButtons=!0},r.fileDrop=function(e,t,n){return r.fileChange(e,t,null!=r.inplaceParams.id&&0!==r.inplaceParams.id?"update":"add")},r.fileChange=function(t,n,a){if(null==a)throw Error("Parameter 'command' required for inplace image");return null!=r.productViewItem?(null!=r.productViewItem.picture.PhotoId&&e.extend(r.inplaceParams,{id:r.productViewItem.picture.PhotoId}),null!=r.productViewItem.colorSelected&&e.extend(r.inplaceParams,{colorId:r.productViewItem.colorSelected.ColorId})):null!=r.product&&(null!=r.product.picture.PhotoId&&"Review"!==r.inplaceParams.field&&e.extend(r.inplaceParams,{id:r.product.picture.PhotoId}),null!=r.product.colorSelected&&e.extend(r.inplaceParams,{colorId:r.product.colorSelected.ColorId})),r.inplaceParams.command=a,o.upload({url:r.inplaceUrl,data:e.extend(r.inplaceParams,{rnd:Math.random()}),file:t}).then(function(e){switch(a){case"add":r.addedImage(e.data,r.inplaceParams.field);break;case"update":r.updatedImage(e.data,r.inplaceParams.field);break;case"delete":r.deletedImage(e.data,r.inplaceParams.field)}})},r.addedImage=function(e,n){var l,c,o,u,p,s,d=r.tagImage;if(null!=e&&e.length>0&&null!=n)switch(n){case"Logo":case"Brand":case"News":case"CategorySmall":case"CategoryBig":case"Review":d.src=e[0].filename;break;case"Product":for(var m=0,f=e.length;m<f;m++)d.src=e[m].filename,(u=new Function("return "+d.getAttribute("data-inplace-params"))()).id=e[m].id,d.setAttribute("data-inplace-params",JSON.stringify(u).replace(/"/g,"'")),0===m&&(null!=r.productViewItem?(r.productViewItem.picture.PhotoId=u.id,r.productViewItem.clearPhotos()):null!=r.product&&i.location.reload(!0));break;case"Carousel":o=(c=(l=r.carousel).carouselNative.getActiveItem().cloneNode(!0)).querySelector("[data-inplace-image]"),c.querySelector(".inplace-buttons").parentNode.removeChild(c.querySelector(".inplace-buttons")),(u=new Function("return "+o.getAttribute("data-inplace-params"))()).id=e[0].id,o.id="inplaceImage_"+e[0].id,o.setAttribute("data-inplace-params",JSON.stringify(u).replace(/"/g,"'")),(p=new Function("return "+o.getAttribute("data-inplace-image-buttons-visible"))()).add=!0,p.update=!0,p.delete=!0,p.permanentVisible=!1,o.setAttribute("data-inplace-image-buttons-visible",JSON.stringify(p).replace(/"/g,"'")),o.src=e[0].filename,1===l.carouselNative.items.length&&!0===(s=new Function("return "+l.carouselNative.getActiveItem().querySelector("[data-inplace-image]").getAttribute("data-inplace-image-buttons-visible"))()).add&&!1===s.update&&!1===s.delete&&l.carouselNative.removeItem(l.carouselNative.getActiveItem(),!1),l.carouselNative.addItem(c),o.complete&&void 0===o.naturalWidth&&0!==o.naturalWidth?(l.carouselNative.update(),l.carouselNative.goto(l.carouselNative.items.length>0?l.carouselNative.items.length-1:0)):o.onload=function(){l.carouselNative.update(),l.carouselNative.goto(l.carouselNative.items.length>0?l.carouselNative.items.length-1:0)},t(o)(a);break;default:throw Error("Unknow type for inplace image: "+n)}},r.updatedImage=function(e,t){var n,a=r.tagImage;if(null!=e&&e.length>0&&null!=t)switch(t){case"Logo":case"Brand":case"News":case"CategorySmall":case"CategoryBig":case"Carousel":case"Review":a.src=e[0].filename;break;case"Product":a.src=e[0].filename,(n=new Function("return "+a.getAttribute("data-inplace-params"))()).id=e[0].id,a.setAttribute("data-inplace-params",JSON.stringify(n).replace(/"/g,"'")),null!=r.productViewItem?(r.productViewItem.picture.PhotoId=n.id,r.productViewItem.clearPhotos()):null!=r.product&&i.location.reload();break;default:throw Error("Unknow type for inplace image: "+t)}},r.deletedImage=function(e,n){var c,o,u,p,s,d,m=r.tagImage;if(null!=e&&e.length>0&&null!=n)switch(n){case"Logo":case"Brand":case"News":case"CategorySmall":case"CategoryBig":case"Review":m.src=e[0].filename;break;case"Product":m.src=e[0].filename,(s=new Function("return "+m.getAttribute("data-inplace-params"))()).id=e[0].id,m.setAttribute("data-inplace-params",JSON.stringify(s).replace(/"/g,"'")),null!=r.productViewItem?(r.productViewItem.picture.PhotoId=s.id,r.productViewItem.clearPhotos()):null!=r.product&&i.location.reload();break;case"Carousel":null!=(c=r.carousel)&&(1===c.carouselNative.items.length&&(p=(u=c.carouselNative.getActiveItem().cloneNode(!0)).querySelector("[data-inplace-image]"),u.querySelector(".inplace-buttons").parentNode.removeChild(u.querySelector(".inplace-buttons")),(s=new Function("return "+p.getAttribute("data-inplace-params"))()).id=0,p.setAttribute("data-inplace-params",JSON.stringify(s).replace(/"/g,"'")),(d=new Function("return "+p.getAttribute("data-inplace-image-buttons-visible"))()).update=!1,d.delete=!1,d.permanentVisible=!0,p.setAttribute("data-inplace-image-buttons-visible",JSON.stringify(d).replace(/"/g,"'")),p.src=e[0].filename),o=l.closest(m,".js-carousel-item").carouselItemData.index,c.carouselNative.removeItem(c.carouselNative.items[o],!1),null!=u&&(c.carouselNative.addItem(u),t(p)(a)),null==p||p.complete&&void 0===p.naturalWidth&&0!==p.naturalWidth?(c.carouselNative.update(),c.carouselNative.goto(c.carouselNative.items.length-1)):p.onload=function(){c.carouselNative.update(),c.carouselNative.goto(c.carouselNative.items.length-1)});break;default:throw Error("Unknow type for inplace image: "+n)}}};e.module("inplace").controller("InplaceImageCtrl",t),t.$inject=["$compile","$element","$scope","$window","domService","inplaceService","Upload"]}(window.angular),function(e){"use strict";var t=function(e){var t=this;t.$onInit=function(){t.inplaceImage=e.getInplaceImage(t.inplaceImageButtons),t.inplaceImage.buttons=t,t.buttonsVisible=t.inplaceImage.inplaceImageButtonsVisible},t.add=function(e,n){"change"===n.type&&t.inplaceImage.fileChange(e,n,"add")},t.update=function(e,n){"change"===n.type&&t.inplaceImage.fileChange(e,n,"update")},t.delete=function(e){t.inplaceImage.fileChange(null,e,"delete")}};window.angular.module("inplace").controller("InplaceImageButtonsCtrl",t),t.$inject=["inplaceService"]}(),function(e){"use strict";var t=function(t){var n=this;n.$onInit=function(){n.needReinit={},n.inplaceParams=n.inplaceParams(),n.active=function(){n.isShow=!0}},n.save=function(){if(null!=n.product&&null!=n.product.offerSelected){var a,i=n.convertToFloat(n.editor.getData());null!=i&&(a=e.extend(n.inplaceParams,{content:i,id:n.product.offerSelected.OfferId,field:n.type}),t.save(n.inplaceUrl,a).finally(function(){n.isShow=!1,n.product.refreshPrice().then(function(){n.setNeedReinit()})}))}},n.setNeedReinit=function(){for(var e in n.needReinit)n.needReinit.hasOwnProperty(e)&&(n.needReinit[e]=!0)},n.cancel=function(){n.isShow=!1,n.editor.bodyElement.innerHTML=n.startContent},n.convertToFloat=function(e){var t=e.replace(/,/g,".").replace(/ /g,"").replace(/&nbsp;/g,"");return t=0===e.length?0:!1===/^[0-9]+(\.[0-9][0-9])?$/.test(t)?null:parseFloat(t)}};e.module("inplace").controller("InplacePriceCtrl",t),t.$inject=["inplaceService"]}(window.angular),function(e){"use strict";var t=function(e,t){var n=this;n.$onInit=function(){n.inplacePrice=t.getInplacePrice(n.inplacePricePanel),n.inplacePrice.panel={element:e,ctrl:n}}};window.angular.module("inplace").controller("InplacePricePanelCtrl",t),t.$inject=["$element","inplaceService"]}(),function(e){"use strict";var t=function(e,t){var n=this;n.$onInit=function(){n.inplacePrice=t.getInplacePrice(n.inplacePriceButtons),n.inplacePrice.buttons={element:e,ctrl:n}},n.btnSave=function(){n.inplacePrice.clickedButtons=!0,n.inplacePrice.save()},n.btnCancel=function(){n.inplacePrice.clickedButtons=!0,n.inplacePrice.cancel()}};window.angular.module("inplace").controller("InplacePriceButtonsCtrl",t),t.$inject=["$element","inplaceService"]}(),function(e){"use strict";var t=function(e){var t=this;t.$onInit=function(){t.state=e.getProgressState()}};window.angular.module("inplace").controller("InplaceProgressCtrl",t),t.$inject=["inplaceService"]}(),function(e){"use strict";var t=function(t){var n=this,a={show:!1},i={rich:{},inplaceAutocomplete:{},inplaceImage:{},inplacePrice:{}};n.addRich=function(e,t){i.rich[e]=t},n.getRich=function(e){return i.rich[e]},n.addInplaceAutocomplete=function(e,t){i.inplaceAutocomplete[e]=t},n.getInplaceAutocomplete=function(e){return i.inplaceAutocomplete[e]},n.addInplaceImage=function(e,t){i.inplaceImage[e]=t},n.getInplaceImage=function(e){return i.inplaceImage[e]},n.addInplacePrice=function(e,t){i.inplacePrice[e]=t},n.getInplacePrice=function(e){return i.inplacePrice[e]},n.save=function(n,a){return t.post(n,e.extend(a,{rnd:Math.random()}))},n.setEnable=function(e){return t.post("inplaceeditor/setenable",{isEnabled:e}).then(function(e){return e.data})},n.getProgressState=function(){return a},n.startProgress=function(){a.show=!0},n.stopProgress=function(){a.show=!1}};e.module("inplace").service("inplaceService",t),t.$inject=["$http"]}(window.angular);